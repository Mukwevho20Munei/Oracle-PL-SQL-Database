SET SERVEROUTPUT ON
DECLARE
C_CUSTOMER_NAME CUSTOMER.FIRST_NAME%TYPE;
C_CUSTOMER_SURNAME CUSTOMER.SURNAME%TYPE;
C_COIN_ID COIN.COIN_ID%TYPE;
C_PRICE COIN.PRICE%TYPE;
C_DISCOUNT_PRICE NUMBER;
C_DELIVERY_DATE COIN_DELIVERY.DELIVERY_DATE%TYPE;
C_INVOICE_DATE INVOICE.INVOICE_DATE%TYPE;
CURSOR C_DISCOUNT IS
SELECT FIRST_NAME, SURNAME, CC.COIN_ID, CO.PRICE, CD.DELIVERY_DATE, I.INVOICE_DATE
FROM INVOICE I
JOIN CUSTOMER C ON C.CUSTOMER_ID = IV.CUSTOMER_ID
JOIN COIN_DELIVERY CD ON D.DELIVERY_ID = IV.DELIVERY_ID
JOIN COIN C ON CC.COIN_ID = IV.COIN_ID
WHERE IV.INVOICE_DATE BETWEEN '18 MAY 2021' AND '20 MAY 2021' ;
BEGIN
OPEN C_DISCOUNT;
LOOP
FETCH C_DISCOUNT
INTO C_CUSTOMER_NAME, C_CUSTOMER_SURNAME, C_COIN_ID, C_PRICE, C_DELIVERY_DATE,
C_INVOICE_DATE;
C_DISCOUNT_PRICE := C_PRICE * 25/100;

EXIT WHEN C_DISCOUNT%NOTFOUND;

DBMS_OUTPUT.PUT_LINE('FIRST NAME: ' || C_CUSTOMER_NAME);
DBMS_OUTPUT.PUT_LINE('SURNAME: ' || C_CUSTOMER_SURNAME);
DBMS_OUTPUT.PUT_LINE('COIN ID: ' || C_COIN_ID);
DBMS_OUTPUT.PUT_LINE('PRICE: ' || C_PRICE);
DBMS_OUTPUT.PUT_LINE('DISCOUNT: ' || C_DISCOUNT_PRICE);
DBMS_OUTPUT.PUT_LINE('DELIVERY DATE: ' || C_DELIVERY_DATE);
DBMS_OUTPUT.PUT_LINE('INVOICE DATE: ' || C_INVOICE_DATE);
DBMS_OUTPUT.PUT_LINE('------------------------');
END LOOP;
END;
