SET SERVEROUTPUT ON
DECLARE
C_CUSTOMER_NAME CUSTOMER.FIRST_NAME%TYPE;
C_CUSTOMER_SURNAME CUSTOMER.SURNAME%TYPE;
C_EMPLOYEE_NAME EMPLOYEE.FIRST_NAME%TYPE;
C_EMPLOYEE_SURNAME EMPLOYEE.SURNAME%TYPE;
C_PRODUCT COIN.PRODUCT%TYPE;
C_RETURN_REASON COIN_RETURNS.REASON%TYPE;
C_RETURN_DATE COIN_RETURNS.RETURN_DATE%TYPE;
CURSOR C_COIN_RETURN IS
SELECT C.FIRST_NAME, C.SURNAME, E.FIRST_NAME, E.SURNAME, PRODUCT, REASON, RETURN_DATE
FROM COIN_RETURNS CR
JOIN CUSTOMER C ON C.CUSTOMER_ID = IV.CUSTOMER_ID
JOIN EMPLOYEE E ON E.EMPLOYEE_ID = IV.EMPLOYEE_ID
JOIN COIN C ON CC.COIN_ID = IV.COIN_ID;
BEGIN
OPEN C_COIN_RETURN;
LOOP
FETCH C_COIN_RETURN
INTO C_CUSTOMER_NAME, C_CUSTOMER_SURNAME, C_EMPLOYEE_NAME, C_EMPLOYEE_SURNAME,
C_PRODUCT, C_RETURN_REASON, C_RETURN_DATE;
EXIT WHEN C_COIN_RETURN%NOTFOUND;
DBMS_OUTPUT.PUT_LINE('CUSTOMER: ' || C_CUSTOMER_NAME || ' '|| C_CUSTOMER_SURNAME);
DBMS_OUTPUT.PUT_LINE('EMPLOYEE: ' || C_EMPLOYEE_NAME || ' ' || C_EMPLOYEE_SURNAME);
DBMS_OUTPUT.PUT_LINE('PRODUCT: ' || C_PRODUCT);
DBMS_OUTPUT.PUT_LINE('REASON: ' || C_RETURN_REASON);
DBMS_OUTPUT.PUT_LINE('DATE: ' || C_RETURN_DATE);
DBMS_OUTPUT.PUT_LINE('------------------------');
END LOOP;
END;
